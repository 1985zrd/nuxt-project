(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{368:function(e,t,r){var content=r(372);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(9).default)("58f6e679",content,!0,{sourceMap:!1})},371:function(e,t,r){"use strict";var o=r(368);r.n(o).a},372:function(e,t,r){(t=r(8)(!1)).push([e.i,".v-note-show.single-show{-webkit-transition:none!important;transition:none!important}.markdown-body{overflow:hidden;box-shadow:none!important;border:1px solid #dcdfe6!important}.markdown-body code{font-family:serif;font-family:initial}.mavon-editor .v-note-wrapper{max-height:600px}.mavon-editor .v-note-wrapper.fullscreen{max-height:none}.mavon-preview .markdown-body{border:0!important}.mavon-preview .v-show-content{background-color:transparent!important}.mavon-preview pre{font-size:14px!important}.hljs-quote{font-style:none!important}.v-note-op{position:-webkit-sticky;position:sticky;top:0;z-index:1}",""]),e.exports=t},381:function(e,t,r){var content=r(396);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(9).default)("cc030730",content,!0,{sourceMap:!1})},384:function(e,t,r){"use strict";r(26);var o,n=r(4),l=r(27),c={name:"markdown",props:{value:{type:String,default:""},preview:{type:Boolean,default:!1}},data:function(){return{subfield:!1,editable:!this.preview,toolbarsFlag:!this.preview,defaultOpen:this.preview?"preview":"edit",toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}},computed:{content:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{uploadImg:(o=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("file",r),e.next=4,Object(l.j)(o);case 4:if(0===(n=e.sent).code){e.next=7;break}return e.abrupt("return",this.$message.error(n.message));case 7:this.$refs.mavon.$img2Url(t,n.data.url);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)}),deleteImg:function(){console.log("del img")}}},m=(r(371),r(5)),component=Object(m.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mavonEditor",class:[e.preview?"mavon-preview":"mavon-editor"]},[r("client-only",[r("mavon-editor",{ref:"mavon",attrs:{toolbars:e.toolbars,subfield:e.subfield,editable:e.editable,toolbarsFlag:e.toolbarsFlag,defaultOpen:e.defaultOpen,transition:!1},on:{imgAdd:e.uploadImg,imgDel:e.deleteImg},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)],1)}),[],!1,null,null,null);t.a=component.exports},395:function(e,t,r){"use strict";var o=r(381);r.n(o).a},396:function(e,t,r){(t=r(8)(!1)).push([e.i,".write_artical{padding:10px 20px}.write_artical-title{text-align:center;margin:10px 0}.avatar-uploader .el-upload{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload:hover{border-color:#409eff}.avatar-uploader-icon{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.avatar{width:178px;height:178px;display:block}",""]),e.exports=t},406:function(e,t,r){"use strict";r.r(t);r(26);var o,n,l,c=r(4),m=r(384),d=r(25),f=r(27),v={components:{Markdown:m.a},data:function(){return{form:{_id:"",title:"",introduction:"",content:"",imageUrl:"",category:"",state:2,anonymous:!1},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],introduction:[{required:!0,message:"请输入简介",trigger:"blur"}],content:[{required:!0,message:"请编辑内容",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"blur"}]}}},watch:{"form.state":function(e,t){1===e&&(this.form.anonymous=!1)}},computed:{categories:function(){return this.$store.state.categories}},mounted:function(){this.form._id=this.$route.query.id||"",this.categories.length||this.getCategory()},methods:{getCategory:(l=Object(c.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.c)();case 2:t=e.sent,this.$store.commit("setCategory",t.data);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)}),upload:(n=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,o,n,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.d)(t.file);case 3:if(r=e.sent,o=r.height,n=r.width,!(o>2e3||n>3e3)){e.next=9;break}return this.$message("图片像素太大了"),e.abrupt("return");case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),this.$message(e.t0.message),e.abrupt("return");case 15:if(!(t.file.size>2097152)){e.next=19;break}return this.$message("图片不能超过2M"),e.abrupt("return");case 19:return(l=new FormData).append("file",t.file),e.next=23,Object(f.j)(l);case 23:c=e.sent,this.form.imageUrl=c.data.url;case 25:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return n.apply(this,arguments)}),saveVertical:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.save()}))},save:(o=Object(c.a)(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.e)(this.form);case 2:t=e.sent,this.$message(t.message),200===t.code&&setTimeout((function(){r.$router.push("/")}),2e3);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})}},h=(r(395),r(5)),component=Object(h.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container_module"},[r("div",{staticClass:"container_module-wrap"},[r("div",{staticClass:"container_module-left write_artical"},[r("h3",{staticClass:"write_artical-title"},[e._v("开始/编辑一篇文章")]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入标题",maxlength:"20","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"简介：",prop:"introduction"}},[r("el-input",{attrs:{maxlength:"200","show-word-limit":"",type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"请输入简介"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"封面图："}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":e.upload,"show-file-list":!1}},[e.form.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"内容：",prop:"content"}},[r("Markdown",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"分类",prop:"category"}},[r("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categories,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e._id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"选项："}},[r("el-radio-group",{model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[r("el-radio",{attrs:{label:1}},[e._v("草稿")]),e._v(" "),r("el-radio",{attrs:{label:2}},[e._v("发布")])],1),e._v(" "),r("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:2===e.form.state,expression:"form.state === 2"}],staticStyle:{"margin-left":"30px"},attrs:{label:"是否匿名发布"},model:{value:e.form.anonymous,callback:function(t){e.$set(e.form,"anonymous",t)},expression:"form.anonymous"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveVertical("form")}}},[e._v("提交")])],1)],1)],1)])])}),[],!1,null,null,null);t.default=component.exports}}]);